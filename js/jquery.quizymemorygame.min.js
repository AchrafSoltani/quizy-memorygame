if(!Array.indexOf){Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++){if(this[b]==a){return b}}return-1}}(function(a){a.fn.quizyMemoryGame=function(b){var c=a.extend({},a.fn.quizyMemoryGame.defaults,b);var d=a(this).children("ul").children("li").length;var e=new Array;var f=new Array;var g="quizy-mg-item";var h="";var i=-1;var j=0;var k=0;var l=0;var m=0;var n;var o=c.openDelay;var p=c.itemWidth;var q=c.itemHeight;var r=c.itemsMargin;var s=Math.round(d/c.colCount);var t=function(){if(k==0)n=setInterval(z,1e3);k++;u(a(this));w(a(this));var b=a(this).attr("id");var p=parseInt(b.substring(g.length,b.length));var q=f[p];if(j==0){j++;h=q;i=b}else if(j==1){j=0;if(q==h){y("correct");u(a("."+q));e.push(b);e.push(i);l++;if(l==d/2){clearInterval(n);if(c.gameSummary){a("div#quizy-game-summary").children("div#gs-column2").html(k+"<br>"+c.textSummaryClicks);a("div#quizy-game-summary").children("div#gs-column3").html(m+"<br>"+c.textSummaryTime);a("div#quizy-game-summary").delay(2e3).fadeIn(1e3)}if(c.onFinishCall!=""){c.onFinishCall({clicks:k,time:m})}}}else{y("wrong");u(a("div."+g));x(a("div#"+i));x(a(this));setTimeout(function(){a("."+g).each(function(){var b=a(this).attr("id");if(e.indexOf(b)==-1){v(a(this))}})},o+c.animSpeed+250)}}};var u=function(a){a.unbind("click");a.css("cursor","default")};var v=function(a){a.bind("click",t);a.css("cursor","pointer")};var w=function(b){var d=b.children("div.quizy-mg-item-top").attr("id");switch(c.animType){default:case"fade":a("#"+d).fadeOut(c.animSpeed);break;case"flip":b.flip({direction:c.flipAnim,speed:c.animSpeed,content:b.children("div.quizy-mg-item-bottom"),color:"#777"});break;case"scroll":a("#"+d).animate({height:"toggle",opacity:.3},c.animSpeed);break}};var x=function(b){var d=b.children("div.quizy-mg-item-top").attr("id");switch(c.animType){default:case"fade":a("#"+d).delay(o).fadeIn(c.animSpeed);break;case"flip":setTimeout(function(){b.revertFlip()},o);break;case"scroll":a("#"+d).delay(o).animate({height:"toggle",opacity:1},c.animSpeed);break}};var y=function(b){if(c.resultIcons){var d;var e=Math.round(o/3);if(b=="wrong"){d=a("div#quizy-mg-msgwrong")}else if(b=="correct"){d=a("div#quizy-mg-msgcorrect")}d.delay(e).fadeIn(e/2).delay(e/2).hide("explode",e/2)}};var z=function(){m++};a(this).children("ul").hide();a(this).css({height:s*(p+r)+"px"});var A=Array();for(var B=0;B<d;B++){A.push(B)}var C=0;while(C<d){var D=Math.floor(Math.random()*A.length);var B=A[D];A.splice(D,1);var E=a(this).children("ul").children("li").eq(B);var F=(C+c.colCount)%c.colCount;var G=Math.floor(C/c.colCount);var H=F*(p+r);var I=G*(q+r);a(this).append('<div id="'+g+B+'" class="'+g+'" style="width:'+p+"px; height:"+q+"px; left:"+H+"px; top:"+I+'px">'+'<div class="quizy-mg-item-bottom"><div class="mgcard-show">'+E.html()+'</div></div><div id="quizy-mg-item-top'+B+'" class="quizy-mg-item-top" style="width:'+p+"px; height:"+q+'px;"></div></div>');C++;f[B]=E.attr("class")}a(this).children("ul").remove();if(c.resultIcons){a(this).append('<div id="quizy-mg-msgwrong"'+' class="quizy-mg-notification-fly quizy-mg-notification-fly-neg"></div>'+'<div id="quizy-mg-msgcorrect" class="quizy-mg-notification-fly '+' quizy-mg-notification-fly-pos"></div>');var J=a(this).width()/2-a("div.quizy-mg-notification-fly").width()/2;var K=a(this).height()/2-a("div.quizy-mg-notification-fly").height()/2-c.itemsMargin/2;a("div.quizy-mg-notification-fly").css({top:K+"px",left:J+"px"})}if(c.gameSummary){a(this).append('<div id="quizy-game-summary"><div id="gs-column1">'+c.textSummaryTitle+'</div><div id="gs-column2"></div>'+'<div id="gs-column3"></div></div>');var J=a(this).width()/2-a("div#quizy-game-summary").width()/2;var K=a(this).height()/2-a("div#quizy-game-summary").height()/2-c.itemsMargin/2;a("div#quizy-game-summary").css({top:K+"px",left:J+"px"});a("div#quizy-game-summary").click(function(){a(this).remove()})}a(".quizy-mg-item").click(t)};a.fn.quizyMemoryGame.defaults={itemWidth:156,itemHeight:156,itemsMargin:10,colCount:4,animType:"scroll",animSpeed:250,openDelay:2500,flipAnim:"rl",resultIcons:true,gameSummary:true,textSummaryTitle:"Your game summary",textSummaryClicks:"clicks",textSummaryTime:"seconds",onFinishCall:""}})(jQuery)